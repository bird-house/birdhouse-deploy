# All env in this default.env can be overridden by env.local.

# Note:
#   Twitcher version is determined by the associated MAGPIE_VERSION.
#   This is because Twitcher must be built with the MagpieAdapter component.
#   (https://github.com/Ouranosinc/Magpie/blob/master/Dockerfile.adapter)
#   The following reference is only indicative for the 'service-config.json'.
export TWITCHER_VERSION=0.10.0
export TWITCHER_RELEASE='${TWITCHER_VERSION}-magpie-${MAGPIE_VERSION}'
export TWITCHER_DOCKER=pavics/twitcher
export TWITCHER_IMAGE='${TWITCHER_DOCKER}:magpie-${MAGPIE_VERSION}'

export TWITCHER_LOG_LEVEL=INFO
export BIRDHOUSE_VERIFY_SSL="true"

export TWITCHER_PROTECTED_PATH=/twitcher/ows/proxy

# Endpoint to verify Magpie/Twitcher authorization to a service/resource by a user without proxy request
# Requires Twitcher>=0.8.0
export TWITCHER_VERIFY_PATH='$(echo "${TWITCHER_PROTECTED_PATH}" | sed "s/proxy/verify/")'

export DELAYED_EVAL="
  $DELAYED_EVAL
  TWITCHER_VERIFY_PATH
  TWITCHER_VERSION
  TWITCHER_RELEASE
  TWITCHER_IMAGE
"

# add any new variables not already in 'VARS' or 'OPTIONAL_VARS' that must be replaced in templates here
VARS="
  $VARS
  \$TWITCHER_PROTECTED_PATH
  \$TWITCHER_VERIFY_PATH
  \$BIRDHOUSE_VERIFY_SSL
"

OPTIONAL_VARS="
  $OPTIONAL_VARS
  \$TWITCHER_LOG_LEVEL
  \$TWITCHER_VERSION
  \$TWITCHER_RELEASE
  \$TWITCHER_DOCKER
  \$TWITCHER_IMAGE
"

# add any component that this component requires to run
COMPONENT_DEPENDENCIES="
  ./components/magpie
"
