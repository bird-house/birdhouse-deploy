export STAC_POSTGRES_USER=${POSTGRES_PAVICS_USERNAME}
export STAC_POSTGRES_PASSWORD=${POSTGRES_PAVICS_PASSWORD}
export STAC_PGUSER=${POSTGRES_PAVICS_USERNAME}
export STAC_PGPASSWORD=${POSTGRES_PAVICS_PASSWORD}

# 'main' branch points at https://github.com/stac-utils/stac-fastapi/commit/d53e792
# (see: https://github.com/crim-ca/stac-app/blob/40cad1aa7a094d58fca2d3184182761e248f781d/Dockerfile#L15-L20)
# which corresponds to 2.4.3 release
export STAC_VERSION=2.4.3-crim-main
export STAC_IMAGE='ghcr.io/crim-ca/stac-app:main'
export STAC_IMAGE_URI='${STAC_IMAGE}'

# 'docker_image_push' branch points at https://github.com/crim-ca/stac-browser/tree/docker_image_push
# which is some commits ahead of 'v3.0.0-beta.5' (and multiple behind latest official releases)
# version name is slightly tweaked to fulfill schema while leaving an obvious trace
export STAC_BROWSER_VERSION=3.0.0-beta.5-crim-docker-image-push
export STAC_BROWSER_IMAGE='ghcr.io/crim-ca/stac-browser:docker_image_push'
export STAC_BROWSER_IMAGE_URI='${STAC_BROWSER_IMAGE}'

# add any new variables not already in 'VARS' or 'OPTIONAL_VARS' that must be replaced in templates here
# single quotes are important in below list to keep variable names intact until 'pavics-compose' parses them
EXTRA_VARS='
  $STAC_POSTGRES_USER
  $STAC_POSTGRES_PASSWORD
  $STAC_PGUSER
  $STAC_PGPASSWORD
'
# extend the original 'VARS' from 'birdhouse/pavics-compose.sh' to employ them for template substitution
# adding them to 'VARS', they will also be validated in case of override of 'default.env' using 'env.local'
VARS="$VARS $EXTRA_VARS"

export DELAYED_EVAL="
  $DELAYED_EVAL
  STAC_IMAGE
  STAC_IMAGE_URI
  STAC_BROWSER_IMAGE
  STAC_BROWSER_IMAGE_URI
"

OPTIONAL_VARS="
  $OPTIONAL_VARS
  \$STAC_VERSION
  \$STAC_IMAGE
  \$STAC_IMAGE_URI
  \$STAC_BROWSER_VERSION
  \$STAC_BROWSER_IMAGE
  \$STAC_BROWSER_IMAGE_URI
"
